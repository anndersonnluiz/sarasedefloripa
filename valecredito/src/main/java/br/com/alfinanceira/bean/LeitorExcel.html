<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_06) on Tue Sep 26 21:14:08 BRT 2006 -->
<TITLE>
LeitorExcel
</TITLE>

<META NAME="keywords" CONTENT="br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.LeitorExcel class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="LeitorExcel";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;NEXT CLASS</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../../../index.html?br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/LeitorExcel.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="LeitorExcel.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
br.eti.rogerioaguilar.minhasclasses.util.excel.leitor</FONT>
<BR>
Class LeitorExcel</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../../../../resources/inherit.gif" ALT="extended by "><B>br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.LeitorExcel</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>LeitorExcel</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
Classe que faz a leitura dos dados de um planilha do excel de acordo com a string passada como parâmetro <br>
 no construtor da classe. Esta string segue a seguinte gramática:                                                                                       <br>
                                                                                                                                                                                                                        <br>
 GRAMATICA := REG(-REG)*                                                                                                                                                                        <br>
 REG := [linha|*|linha-linha, coluna(;coluna)* |*]                                                                                                              <br>    
 linha := número inteiro ou *                                                                                                                                                           <br>
 coluna := número inteiro ou *                                                                                                                                                  <br>
                                                                                                                                                                                                                        <br>
 Devem ser expecificados os índices das linhas e/ou colunas desejadas para que o programa faça a leitura  <br>
 A primeira linha da planilha possui o índice 1 e a primeira coluna também possui este índice                           <br>
 Exemplos de utilização da string:                                                                                                                                              <br>
                                                                                                                                                                                                                        <br>
 [*,*] --> O programa irá ler todas as linhas e colunas da planilha que possuírem algum conteúdo                        <br>    
 [1,*] --> O programa irá ler todas as colunas da primeira linha da planilha                                                            <br>
 [2,5] --> o programa irá ler a coluna 5 da segunda linha da planilha                                                                           <br>
 [2,1;2] --> O programa irá ler as colunas 1 e dois da segunda linha da planilha                                                        <br>
 [*,1] --> O programa irá ler todas as colunas com índice 1 de todas as linhas da planilha                              <br>
 [*,4;5] --> O programa irá ler as colunas com índice 4 e 5 de todas as linhas da planilha                              <br>
                         algum conteúdo                                                                                                                                                                 <br>
 [1-10,1] --> O programa irá ler a coluna 1 de todas as linhas que estiverem entre os índices 1 e 10            <br>
                                que possuam conteúdo                                                                                                                                            <br>
 [1-10,1;2;3] --> O programa irá ler as colunas 1, 2 e 3 de todas as linhas que estiverem entre os índices<br>
                        1 e 10                                                                                                                                                                          <br>
                                que possuam conteúdo                                                                                                                                            <br>
 [1,1;2;3;4;5] --> O programa irá ler as colunas 1, 2, 3, 4 e 5 da primeira linha da planilha                           <br>
 [1,1;2]-[5,4;5] --> O programa irá ler as colunas 1 e dois da primeira linha da planilha e as colunas    <br>
                                           4 e 5 da linha 5                                                                                                                                             <br>
 OBS: A combinação acima pode ser repetida para diferentes configurações de linha quantas vezes                 <br>
 for necessário.                                                                                                                                                                                        <br>
                                                                                                                                                                                                                        <br>
 Exemplo de configurações diferentes para várias linhas de uma planilha:                                                                        <br>
 [1,1;2]-[2,10;20]-[5,3;7;15]-[7,1;4;7;8;20;30]                                                                                                                 <br>
                                                                                                                                                                                                                        <br>
 A classe possui dois construtores que devem ser utilizados para inicializar a leitura de uma planilha. <br>
 Além da String contendo as linhas e colunas que devem ser lidas, as outras informações que devem ser   <br>
 passadas para os construtores são:                                                                                                                                                     <br>            
                                                                                                                                                                                                                        <br>
 indicePlanilha --> Índice da planilha que será lida no arquivo (a primeira planilha tem o índice 1)            <br>
 
 caminhoArquivoExcel (primeiro construtor) --> caminho completo do arquivo da planilha excel                            <br>
                                                                                                        OU                                                                                                              <br>
 streamArquivo (segundo construtor) --> InputStream para uma planilha                                                                           <br>
 
 
 linhaListener --> Alguma classe que implemente a interface LinhaListener e que será chamada pelo leitor        <br>
                                         quando este ler umas das linhas especificadas na string de leitura                                             <br>
 colunaListener --> Alguma classe que implemente a interface ColunaListener e que será chamada pelo leitor<br>                                                                                                                  
                                         quando este ler uma das colunas especificadas na string de leitura                                     <br>
                                                                                                                                                                                                                        <br>
 Após criar o objeto Leitor com os parâmetros definidos acima, é necessário chamar o método                             <br>
 processarLeituraPlanilha, que irá ler as linhas e colunas especificadas e chamar os listeners correspondentes <br>
 com as informações encontradas na linha e/ou coluna.                                                                                                           <br>
                                                                                                                                                                                                                        <br>
 Fluxo de execução:                                                                                                                                                                             <br>
                                                                                                                                                                                                                        <br>
 1 - O leitor abre a planilha                                                                                                                                                           <br>
 2 - o leitor começa a ler as linhas e colunas da planilha                                                                                              <br>
 3 - Para cada linha encontrada:                                                                                                                                                        <br>
                        3.1 - Caso a linha esteja na lista de linhas que devem ser processadas passada ao construtor:                   <br>
                                     3.1.1 - O leitor monta uma lista de vos contendos os dados das colunas para a linha atual que              <br>
                                                         estejam dentro do padrão de leitura passado ao construtor                                                                      <br>
                                         3.1.2 - O leitor chama o método LinhaListener.lendoLinha passando o mapa com os dados da linha         <br>
                                                         e aguarda o final do processamento.                                                                                                            <br>
                                                         3.1.2.1 - Caso o método do listener retorne true, o leitor continua o processamento da     <br>
                                                                           da planilha. Caso contrário, o processamento da planilha é interrompido                      <br>
                                                                           Se o processamento da planilha continuar (de acordo com o parâmetro de retorno       <br>
                                                                           do listener para a linha descrito anteriormente), o leitor chama o listener para <br>
                                                                           a coluna para cada coluna da linha atual. O comportamento deste listener é o mesmo <br>
                                                                           do listener para a linha, ou seja, se o listener retornar false o processamento da <br>
                                                                           planilha é interrompido.                                                                                                                       <br>  
                                                                                                                                                                                                                                                 <br>                   
 Exemplo de utilização:                                                                                                                                                                                                                                                                 <br>                    
                                                                                                                                                                                                                                                                                                                                <br>                            
1 - Classe Listener que imprime os dados da linha no console:                                                                                                                                                                                                   <br>
                                                                                                                                                                                                                                                                                                                                <br>    
 public class ConsoleLinhaListener implements LinhaListener {                                                                                                                                                                                                   <br>
                                                                                                                                                                                                                                                                                                                                <br>
    public boolean lendoLinha(int linha, Map dadosLinha)                                                                                                                                                                                                                <br>
                        throws ListenerException {                                                                                                                                                                                                                                                      <br>
                System.out.println("***************************************************Listener linha Teste***************************************************");               <br>
                System.out.println("Linha --> " + linha);                                                                                                                                                                                                                               <br>
                System.out.println("Dados linha (MAPA) --> " + dadosLinha);                                                                                                                                                                                             <br>    
                System.out.println("Lista de vos com os dados da linha --> " + dadosLinha.get(LinhaListener.LISTA_VOS_LINHA));                                                                                  <br>
                System.out.println("Objeto original da api poi --> " + dadosLinha.get(LinhaListener.CHAVE_LINHA_OBJETO_ORIGINAL_POI));                                                                  <br>            
                System.out.println("**************************************************************************************************************************");               <br>
                return true;                                                                                                                                                                                                                                                                                    <br>
        }                                                                                                                                                                                                                                                                                                                       <br>
 }                                                                                                                                                                                                                                                                                                                      <br>                                    
                                                                                                                                                                                                                                                                                                                                <br>
 2 - Classe Listener que imprime os dados da coluna no console:                                                                                                                                                                                         <br>
                                                                                                                                                                                                                                                                                                                                <br>
 public class ConsoleColunaListener implements ColunaListener {                                                                                                                                                                                         <br>
    public boolean lendoColuna(int linha, int coluna, Map dadosColuna)                                                                                                                                                                          <br>
                        throws ListenerException {                                                                                                                                                                                                                                                      <br>
                System.out.println("###################################################Coluna Teste###################################################");                               <br>    
                System.out.println("Linha --> " + linha);                                                                                                                                                                                                                               <br>
                System.out.println("Coluna --> " + coluna);                                                                                                                                                                                                                             <br>
                System.out.println("Vo contendo os dados da coluna --> " + dadosColuna.get(ColunaListener.CHAVE_VO_COLUNA));                                                                                    <br>    
                System.out.println("Objeto original da API POI--> " + dadosColuna.get(ColunaListener.CHAVE_COLUNA_OBJETO_ORIGINAL_POI));                                                                <br>
                System.out.println("Dados coluna --> " + dadosColuna);                                                                                                                                                                                                  <br>
                LinhaColunaListenerVo voAtual = (LinhaColunaListenerVo) dadosColuna.get(ColunaListener.CHAVE_VO_COLUNA);                                                                                                <br>
                if(voAtual.isCelulaContemErro()){                                                                                                                                                                                                                                               <br>
                        System.out.println("Erro -->" + voAtual.getErro());                                                                                                                                                                                                     <br>
                }else if(voAtual.isCelulaNula()){                                                                                                                                                                                                                                               <br>            
                        System.out.println("Célula é nula!");                                                                                                                                                                                                                           <br>
                }else if(voAtual.isCelulaBranca()){                                                                                                                                                                                                                                             <br>
                        System.out.println("Célula é branca!");                                                                                                                                                                                                                         <br>    
                }else if(voAtual.isCelulaFormula()){                                                                                                                                                                                                                                    <br>
                        System.out.println("Fórmula --> " + voAtual.getValorStrFormula());                                                                                                                                                                      <br>
                }else if(voAtual.getValorNumerico() != null){                                                                                                                                                                                                                   <br>
                        System.out.println("Valor Numérico --> " + voAtual.getValorNumerico());                                                                                                                                                 <br>
                }else if(voAtual.getValorBoolean() != null){                                                                                                                                                                                                                    <br>
                        System.out.println("Valor booleano --> " + voAtual.getValorBoolean());                                                                                                                                                  <br>
                }else if(voAtual.getValorStr() != null){                                                                                                                                                                                                                                <br>
                        System.out.println("Valor String --> " + voAtual.getValorStr());                                                                                                                                                                <br>
                }                                                                                                                                                                                                                                                                                                               <br>
                System.out.println("##################################################################################################################");                               <br>                    
                return true;                                                                                                                                                                                                                                                                                    <br>
        }                                                                                                                                                                                                                                                                                                                       <br>
 }                                                                                                                                                                                                                                                                                                                      <br>
                                                                                                                                                                                                                                                                                                                                <br>
        3 - Chamada para o leitor processar a leitura da planilha com os listeners definidos anteriormente:                                                                                                                     <br> 
                                                                                                                                                                                                                                                                                                                                <br>
                        InputStream is = new FileInputStream("/usr/local/java/temp/teste.xls");                                                                                                                                                                                 <br>
                        LeitorExcel leitor = new LeitorExcel("[1,1;2]-[2,10;20]-[5,3;7;15]-[7,1;4;7;8;20;30]", 1, is,                                                                                                                                                                                           <br>
                                                new ConsoleLinhaListener(), new ConsoleColunaListener()                                                                                                                                                                 <br>
                                        );                                                                                                                                                                                                                                                                                      <br>
                        leitor.processarLeituraPlanilha();                                                                                                                                                                                                                                      <br>
                                                                                                                                                                                                                                                                                                                                <br>
 Existe uma classe que pode ser utilizada para testes:                                                                                                                                                                                                          <br>    
                                                                                                                                                                                                                                                                                                                                <br>
 Forma de utilização:                                                                                                                                                                                                                                                                                   <br>
 1 - Direto na classe:                                                                                                                                                                                                                                                                          <br>
                java br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.teste.TesteLeitorExcel indicePlanilha padrão de leitura  caminho do arquivo                                  <br>
 Exemplo                                                                                                                                                                                                                                                                                                                <br>                                                                                                                                                    
                java br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.teste.TesteLeitorExcel 1 "[5,5]-[6-27,1;10]" "/usr/local/java/temp/teste.xls"                                <br>
                                                                                                                                                                                                                                                                                                                                <br>
 2 - Através do jar da aplicação:                                                                                                                                                                                                                                                               <br>
                java -jar leitor-excel-0.1-RC01.jar indicePlanilha padrão de leitura  caminho do arquivo                                                                                                                        <br>            
                                                                                                                                                                                                                                                                                                                                <br>
 Exemplo                                                                                                                                                                                                                                                                                                                <br>
                java -jar leitor-excel-0.1-RC01.jar 1 "[5,5]" "/usr/local/java/temp/teste.xls"                                                                                                                                                                          <br>
<P>

<P>
<DL>
<DT><B>Version:</B></DT>
  <DD>0.1</DD>
<DT><B>Author:</B></DT>
  <DD>Rogério de Paula Aguilar</DD>
<DT><B>See Also:</B><DD><A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/util/LinhaColunaListenerVo.html" title="class in br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.util"><CODE><br></CODE></A></DL>
<HR>

<P>

<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/LeitorExcel.html#LeitorExcel(java.lang.String, int, java.io.InputStream, br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.listener.LinhaListener, br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.listener.ColunaListener)">LeitorExcel</A></B>(java.lang.String&nbsp;strPadraoLeitura,
            int&nbsp;indicePlanilha,
            java.io.InputStream&nbsp;streamArquivo,
            <A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/listener/LinhaListener.html" title="interface in br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.listener">LinhaListener</A>&nbsp;linhaListener,
            <A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/listener/ColunaListener.html" title="interface in br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.listener">ColunaListener</A>&nbsp;colunaListener)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Construtor</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/LeitorExcel.html#LeitorExcel(java.lang.String, int, java.lang.String, br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.listener.LinhaListener, br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.listener.ColunaListener)">LeitorExcel</A></B>(java.lang.String&nbsp;strPadraoLeitura,
            int&nbsp;indicePlanilha,
            java.lang.String&nbsp;caminhoArquivoExcel,
            <A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/listener/LinhaListener.html" title="interface in br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.listener">LinhaListener</A>&nbsp;linhaListener,
            <A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/listener/ColunaListener.html" title="interface in br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.listener">ColunaListener</A>&nbsp;colunaListener)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Construtor</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/LeitorExcel.html#processarLeituraPlanilha()">processarLeituraPlanilha</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Realiza o processamento de leitura seguindo o fluxo:
 
 1 - O leitor abre a planilha                                                                                                                                                           <br>
 2 - o leitor começa a ler as linhas e colunas da planilha                                                                                              <br>
 3 - Para cada linha encontrada:                                                                                                                                                        <br>
                        3.1 - Caso a linha esteja na lista de linhas que devem ser processadas passada ao construtor:                   <br>
                                     3.1.1 - O leitor monta uma lista de vos contendos os dados das colunas para a linha atual que              <br>
                                                         estejam dentro do padrão de leitura passado ao construtor                                                                      <br>
                                         3.1.2 - O leitor chama o método LinhaListener.lendoLinha passando o mapa com os dados da linha         <br>
                                                         e aguarda o final do processamento.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/LeitorExcel.html#toString()">toString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="LeitorExcel(java.lang.String, int, java.lang.String, br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.listener.LinhaListener, br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.listener.ColunaListener)"><!-- --></A><H3>
LeitorExcel</H3>
<PRE>
public <B>LeitorExcel</B>(java.lang.String&nbsp;strPadraoLeitura,
                   int&nbsp;indicePlanilha,
                   java.lang.String&nbsp;caminhoArquivoExcel,
                   <A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/listener/LinhaListener.html" title="interface in br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.listener">LinhaListener</A>&nbsp;linhaListener,
                   <A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/listener/ColunaListener.html" title="interface in br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.listener">ColunaListener</A>&nbsp;colunaListener)</PRE>
<DL>
<DD>Construtor
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>strPadraoLeitura</CODE> - padrão para identificar as linhas e colunas que devem ser processadas<DD><CODE>indicePlanilha</CODE> - índice da planilha que será processada, começando em 1<DD><CODE>caminhoArquivoExcel</CODE> - caminho completo do arquivo que será processado<DD><CODE>linhaListener</CODE> - classe que receberá notificações sobre a leitura das linhas<DD><CODE>colunaListener</CODE> - classe que receberá notificações sobre a leitura das colunas</DL>
</DL>
<HR>

<A NAME="LeitorExcel(java.lang.String, int, java.io.InputStream, br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.listener.LinhaListener, br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.listener.ColunaListener)"><!-- --></A><H3>
LeitorExcel</H3>
<PRE>
public <B>LeitorExcel</B>(java.lang.String&nbsp;strPadraoLeitura,
                   int&nbsp;indicePlanilha,
                   java.io.InputStream&nbsp;streamArquivo,
                   <A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/listener/LinhaListener.html" title="interface in br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.listener">LinhaListener</A>&nbsp;linhaListener,
                   <A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/listener/ColunaListener.html" title="interface in br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.listener">ColunaListener</A>&nbsp;colunaListener)</PRE>
<DL>
<DD>Construtor
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>strPadraoLeitura</CODE> - padrão para identificar as linhas e colunas que devem ser processadas<DD><CODE>indicePlanilha</CODE> - índice da planilha que será processada, começando em 1<DD><CODE>streamArquivo</CODE> - Objeto InputStream contendo os dados do arquivo que será processado<DD><CODE>linhaListener</CODE> - classe que receberá notificações sobre a leitura das linhas<DD><CODE>colunaListener</CODE> - classe que receberá notificações sobre a leitura das colunas</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="toString()"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>()</PRE>
<DL>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>toString</CODE> in class <CODE>java.lang.Object</CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="processarLeituraPlanilha()"><!-- --></A><H3>
processarLeituraPlanilha</H3>
<PRE>
public void <B>processarLeituraPlanilha</B>()
                              throws <A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/gramatica/impl/ParseException.html" title="class in br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.gramatica.impl">ParseException</A>,
                                     <A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/exception/PlanilhaNaoEncontradaException.html" title="class in br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.exception">PlanilhaNaoEncontradaException</A>,
                                     java.io.FileNotFoundException,
                                     java.io.IOException,
                                     <A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/exception/ListenerException.html" title="class in br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.exception">ListenerException</A></PRE>
<DL>
<DD>Realiza o processamento de leitura seguindo o fluxo:
 
 1 - O leitor abre a planilha                                                                                                                                                           <br>
 2 - o leitor começa a ler as linhas e colunas da planilha                                                                                              <br>
 3 - Para cada linha encontrada:                                                                                                                                                        <br>
                        3.1 - Caso a linha esteja na lista de linhas que devem ser processadas passada ao construtor:                   <br>
                                     3.1.1 - O leitor monta uma lista de vos contendos os dados das colunas para a linha atual que              <br>
                                                         estejam dentro do padrão de leitura passado ao construtor                                                                      <br>
                                         3.1.2 - O leitor chama o método LinhaListener.lendoLinha passando o mapa com os dados da linha         <br>
                                                         e aguarda o final do processamento.                                                                                                            <br>
                                                         3.1.2.1 - Caso o método do listener retorne true, o leitor continua o processamento da     <br>
                                                                           da planilha. Caso contrário, o processamento da planilha é interrompido                      <br>
                                                                           Se o processamento da planilha continuar (de acordo com o parâmetro de retorno       <br>
                                                                           do listener para a linha descrito anteriormente), o leitor chama o listener para <br>
                                                                           a coluna para cada coluna da linha atual. O comportamento deste listener é o mesmo <br>
                                                                           do listener para a linha, ou seja, se o listener retornar false o processamento da <br>
                                                                           planilha é interrompido.
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/gramatica/impl/ParseException.html" title="class in br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.gramatica.impl">ParseException</A></CODE>
<DD><CODE><A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/exception/PlanilhaNaoEncontradaException.html" title="class in br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.exception">PlanilhaNaoEncontradaException</A></CODE> - caso o índice da planilha não seja encontrado no arquivo
<DD><CODE>java.io.FileNotFoundException</CODE> - caso o arquivo passado como parâmetro não exista
<DD><CODE><A HREF="../../../../../../../br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/exception/ListenerException.html" title="class in br.eti.rogerioaguilar.minhasclasses.util.excel.leitor.exception">ListenerException</A></CODE> - caso ocorra algum erro na chamada de algum dos listeners
<DD><CODE>java.io.IOException</CODE> - caso ocorra algum problema de io</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;NEXT CLASS</FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../../../index.html?br/eti/rogerioaguilar/minhasclasses/util/excel/leitor/LeitorExcel.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="LeitorExcel.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
